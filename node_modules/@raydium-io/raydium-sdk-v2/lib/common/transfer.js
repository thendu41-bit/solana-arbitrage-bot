var g=Object.create;var w=Object.defineProperty,P=Object.defineProperties,S=Object.getOwnPropertyDescriptor,A=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertyNames,B=Object.getOwnPropertySymbols,v=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var l=(e,n,r)=>n in e?w(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,x=(e,n)=>{for(var r in n||(n={}))p.call(n,r)&&l(e,r,n[r]);if(B)for(var r of B(n))M.call(n,r)&&l(e,r,n[r]);return e},h=(e,n)=>P(e,A(n));var D=(e,n)=>{for(var r in n)w(e,r,{get:n[r],enumerable:!0})},N=(e,n,r,u)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of E(n))!p.call(e,t)&&t!==r&&w(e,t,{get:()=>n[t],enumerable:!(u=S(n,t))||u.enumerable});return e};var I=(e,n,r)=>(r=e!=null?g(v(e)):{},N(n||!e||!e.__esModule?w(r,"default",{value:e,enumerable:!0}):r,e)),G=e=>N(w({},"__esModule",{value:!0}),e);var V={};D(V,{BNDivCeil:()=>F,ceilDivBN:()=>O,getTransferAmountFee:()=>y,getTransferAmountFeeV2:()=>Z,minExpirationTime:()=>q});module.exports=G(V);var s=I(require("bn.js")),f=1e4;function y(e,n,r,u){if(n===void 0)return{amount:e,fee:void 0,expirationTime:void 0};let t=r.epoch<n.newerTransferFee.epoch?n.olderTransferFee:n.newerTransferFee,i=new s.default(t.maximumFee.toString()),m=r.epoch<n.newerTransferFee.epoch?(Number(n.newerTransferFee.epoch)*r.slotsInEpoch-r.absoluteSlot)*400/1e3:void 0;if(u)if(t.transferFeeBasisPoints===f){let a=new s.default(t.maximumFee.toString());return{amount:e.add(a),fee:a,expirationTime:m}}else{let a=F(e.mul(new s.default(f)),new s.default(f-t.transferFeeBasisPoints)),o=new s.default(t.maximumFee.toString()),d=a.sub(e).gt(o)?e.add(o):a,c=F(d.mul(new s.default(t.transferFeeBasisPoints)),new s.default(f)),T=c.gt(i)?i:c;return{amount:d,fee:T,expirationTime:m}}else{let a=F(e.mul(new s.default(t.transferFeeBasisPoints)),new s.default(f)),o=a.gt(i)?i:a;return{amount:e,fee:o,expirationTime:m}}}function Z(e,n,r,u){if(n===void 0)return{amount:e,fee:void 0,expirationTime:void 0};let t=h(x({},n),{olderTransferFee:{epoch:BigInt(n.olderTransferFee.epoch),maximumFee:BigInt(n.olderTransferFee.maximumFee),transferFeeBasisPoints:n.olderTransferFee.transferFeeBasisPoints},newerTransferFee:{epoch:BigInt(n.newerTransferFee.epoch),maximumFee:BigInt(n.newerTransferFee.maximumFee),transferFeeBasisPoints:n.newerTransferFee.transferFeeBasisPoints}}),i=r.epoch<t.newerTransferFee.epoch?t.olderTransferFee:t.newerTransferFee,m=new s.default(i.maximumFee.toString()),a=r.epoch<t.newerTransferFee.epoch?(Number(t.newerTransferFee.epoch)*r.slotsInEpoch-r.absoluteSlot)*400/1e3:void 0;if(u)if(i.transferFeeBasisPoints===f){let o=new s.default(i.maximumFee.toString());return{amount:e.add(o),fee:o,expirationTime:a}}else{let o=F(e.mul(new s.default(f)),new s.default(f-i.transferFeeBasisPoints)),d=new s.default(i.maximumFee.toString()),c=o.sub(e).gt(d)?e.add(d):o,T=F(c.mul(new s.default(i.transferFeeBasisPoints)),new s.default(f)),b=T.gt(m)?m:T;return{amount:c,fee:b,expirationTime:a}}else{let o=F(e.mul(new s.default(i.transferFeeBasisPoints)),new s.default(f)),d=o.gt(m)?m:o;return{amount:e,fee:d,expirationTime:a}}}function q(e,n){return e===void 0?n:n===void 0?e:Math.min(e,n)}function F(e,n){let{div:r,mod:u}=e.divmod(n);return u.gt(new s.default(0))?r.add(new s.default(1)):r}function O(e,n){if(e.isZero())return new s.default(0);let r=e.div(n);return r.isZero()?new s.default(1):e.mod(n).gt(new s.default(0))?r.add(new s.default(1)):r}0&&(module.exports={BNDivCeil,ceilDivBN,getTransferAmountFee,getTransferAmountFeeV2,minExpirationTime});
//# sourceMappingURL=transfer.js.map